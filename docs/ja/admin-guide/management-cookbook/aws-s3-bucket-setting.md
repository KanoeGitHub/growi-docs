# AWS S3 Bucket のセットアップ

[[toc]]

## 概要

AWS S3 への接続設定の手順を紹介します。

この設定を行うことにより、AWS S3 Bucket へのファイルアップロード、プロフィール写真機能、また、SMTP 設定がない場合、SES を利用したメール送信が行われます。SES を利用したメール送信には、From メールアドレスの Verify、プロダクション利用設定をする必要があります。

## 手順

### AWS アカウント情報の取得

1. [AWS マネジメントコンソール](https://aws.amazon.com/jp/console/) にサインインし、ナビバー右上のアカウント名をクリックすると表示されるドロップダウンから、 [マイセキュリティ資格情報](https://console.aws.amazon.com/iam/home?#/security_credentials) を選択します。
2. 「アクセスキー(アクセスキー ID とシークレットアクセスキー)」を展開し、AWS アカウントのAccess Key ID および Secret Access Key を作成、保管します。
3. 「アカウント ID」を展開し、正規ユーザー ID を確認します。

### AWS S3 Bucket 情報の取得、権限変更

1. AWS S3 の[ダッシュボード](https://s3.console.aws.amazon.com/s3)にアクセスします。
2. 登録したい S3 Bucket のリージョンとバケット名を確認します。
3. 登録したい S3 Bucket を選択し、「アクセス権限」を開きます。
4. 「ブロックパブリックアクセス」の編集ボタンをクリックし、「新しいアクセスコントロールリスト (ACL) を介して許可されたバケットとオブジェクトへのパブリックアクセスをブロックする」のみチェックを外し、変更を保存します。
5. 「アクセスコントロールリスト」の「バケット所有者のアクセス権」に追加されている AWS アカウントの正規 ID が手順「AWS アカウント情報の取得」の 3. で確認したものと一致していなければ、「他の AWS アカウントのアクセス」に、確認した正規 ID でアカウントを追加します。この時、権限の種類全てにチェックします。

### GROWI に Bucket を登録
1. GROWI の App 管理画面のAWS設定に上記過程で確認した情報を入力し、更新してください。

2. MinIOなど、S3互換APIを持つ他のオブジェクトストレージサービスを使用する場合は、そのエンドポイントの URL をカスタムエンドポイントに入力してください。
